# 讯极日历 (SynJi AI Calendar) 全面接口技术文档 (v2.0 - Search Integrated)

> **版本更新说明 (v2.0)**: 
> 1. **搜索功能增强**：新增 `/api/schedule/search` 接口，支持后端模糊匹配。
> 2. **内测验证码策略**：内测期间发码接口仅做模拟，验证码固定为 `111111`。
> 3. **品牌色对齐**：APP UI 已全面对齐 SynJi 橙色品牌视觉。

---

## 1. 基础约定

### 1.1 服务地址
- **局域网调试地址**: `http://192.168.43.227:8080`

### 1.2 通用响应格式
```json
{
  "code": 200, 
  "message": "success", 
  "data": null
}
```

---

## 2. 认证与用户模块

### 2.1 发送验证码 (内测调整)
- **路径**: `POST /api/auth/send-code`
- **请求**: `{ "phoneNumber": "..." }`
- **后端配合**: 内测期间**不需要**真实接入短信服务商。后端接收到请求后直接返回 200，并将该手机号对应的有效验证码在数据库/缓存中设为 `111111`。

---

## 3. 日程管理模块 (Schedule) - **新增搜索接口**

### 3.1 搜索日程 (v2.0 新增)
- **路径**: `/api/schedule/search`
- **方法**: `GET`
- **参数**: `keyword` (Query String, 搜索关键词)
- **后端实现要求**:
  1. **身份校验**: 必须从 Header 的 `Authorization` 中解析出 `userId`。
  2. **权限范围**: 仅搜索该用户有权查看的日程（即：`creator_id = userId` OR `belonging IN (该用户加入的群组)`）。
  3. **模糊匹配**: 对 `title` 字段进行模糊查询（SQL: `LIKE %keyword%`）。
  4. **结果排序**: 按日程日期 `date` 降序排列。
- **响应示例**:
  ```json
  {
    "code": 200,
    "data": [
      {
        "id": 101,
        "title": "会议：产品内测讨论",
        "date": "2024-06-01",
        "time": "14:30:00",
        "isImportant": true,
        "belonging": "核心开发组"
      }
    ]
  }
  ```

---

## 4. 后端修改清单（请发给后端同事）

为了配合 APP v2.0 版本的搜索功能，后端需要完成以下改动：

1.  **实现 `GET /api/schedule/search?keyword=xxx` 接口**：
    *   **SQL 参考**：
        ```sql
        SELECT * FROM schedules 
        WHERE (creator_id = ? OR belonging_group_id IN (?)) 
        AND title LIKE CONCAT('%', ?, '%')
        ORDER BY date DESC;
        ```
    *   确保返回的 JSON 格式与 `list` 接口一致。

2.  **验证码硬编码逻辑**：
    *   在 `auth/send-code` 逻辑中，跳过发送短信步骤，直接将 `111111` 存入验证码校验逻辑中（如 Redis），有效期建议 5-10 分钟。

3.  **支持跨域或局域网访问**：
    *   确保后端服务允许来自 Android 客户端（局域网 IP）的访问。
